# News Filter

News Filter は、指定したウェブサイト（ニュースサイトなど）において、ユーザーが定義したキーワードに基づいて特定の要素（記事、リスト項目など）を非表示にするウェブブラウザ拡張機能です。見たい情報だけを選び、ノイズを減らして快適なブラウジング体験を提供します。

## 主な機能

*   **キーワードによる非表示:** 登録したキーワードを含む要素をページ上から非表示にします。
*   **簡単なキーワード管理:** ポップアップ画面で、非表示にしたいキーワードを改行区切りで簡単に追加・編集・削除できます。
*   **コンテキストメニュー連携:** ウェブページ上でテキストを選択し、右クリックメニューから直接キーワードとして追加できます（オプションで有効/無効切り替え可能）。
*   **便利なオプション:**
    *   大文字/小文字を区別しないマッチング設定。
    *   キーワードの自動正規化（全角/半角スペース、全角/半角記号、大文字/小文字などを統一してマッチング精度を向上）。
    *   キーワードリストのソート機能。
*   **ブロック数表示:** ツールバーアイコンのバッジに、現在のタブで非表示にした要素の数を表示します。
*   **柔軟なサイト設定:** 高度な設定で、対象とするウェブサイトのドメインと、非表示対象要素を指定するCSSセレクターをJSON形式で自由に設定・追加できます。
*   **複数ブラウザ対応:** Google Chrome と Firefox で動作します。

## インストール

### 各ストアから（準備中）

*   [Firefox Add-ons (AMO)](https://addons.mozilla.org/ja/firefox/addon/newsfilter/)
*   [Chromeウェブストア]() (リンク準備中)

### ソースコードから（開発者向け）

1.  このリポジトリをクローンするか、ZIPファイルをダウンロードして展開します。
2.  **Google Chrome の場合:**
    *   Chrome を開き、アドレスバーに `chrome://extensions` と入力して拡張機能管理ページを開きます。
    *   右上の「デベロッパーモード」をオンにします。
    *   「パッケージ化されていない拡張機能を読み込む」ボタンをクリックします。
    *   ダウンロード・展開したフォルダ（`manifest-chrome.json` があるフォルダ）を選択します。
3.  **Firefox の場合:**
    *   Firefox を開き、アドレスバーに `about:debugging` と入力してデバッグページを開きます。
    *   左側のメニューで「このFirefox」を選択します。
    *   「一時的なアドオンを読み込む」ボタンをクリックします。
    *   ダウンロード・展開したフォルダ内の `manifest-firefox.json` ファイルを選択します。

### ビルド

* Firefox 用の zip ファイルの生成
  ```
  make firefox
  ```

* Google Chrome 用の zip ファイルの生成
  ```
  make chrome
  ```


## 使い方

1.  **ポップアップを開く:**
    *   ブラウザのツールバーに追加された「News Filter」のアイコンをクリックします。

2.  **キーワードの追加・編集:**
    *   「ブロックするキーワード」のテキストエリアに、非表示にしたいキーワードを**1行に1つずつ**入力します。
    *   入力したキーワードは、保存時に自動的に正規化（全角→半角、スペース統一など）されます。
    *   既存のキーワードを編集・削除することも可能です。

3.  **設定の保存:**
    *   キーワードを入力・編集したら、「保存」ボタンをクリックします。設定が保存され、現在開いているページや今後開くページに反映されます。
    *   保存時に、正規化によって重複したキーワードは自動的に削除され、アラートが表示されます。

4.  **キーワードのソート:**
    *   「ソート」ボタンをクリックすると、テキストエリア内のキーワードがアルファベット（辞書順）に並び替えられます。**ソート後も「保存」ボタンを押す必要があります。**

5.  **オプション設定:**
    *   **「大/小無視」:** チェックを入れると、キーワードのマッチング時に大文字と小文字を区別しなくなります。
    *   **「右クリック追加」:** チェックを入れると、ウェブページ上でテキストを選択して右クリックした際に「選択したテキストを News Filter に追加」メニューが表示されるようになります。チェックを外すとメニューは表示されません。

6.  **コンテキストメニューからの追加（有効時）:**
    *   ウェブページ上で非表示にしたい単語やフレーズを選択します。
    *   右クリックし、「選択したテキストを News Filter に追加」を選択します。
    *   選択したテキストがキーワードリストに追加され保存されます（ポップアップを開いて確認できます）。

7.  **新しいタブで設定を開く:**
    *   「新しいタブで設定を開く」ボタンをクリックすると、ポップアップと同じ設定画面が新しいタブで開きます。広い画面で設定したい場合に便利です。

8.  **ブロック数の確認:**
    *   拡張機能が有効なサイト（高度な設定の`hosts`にマッチするサイト）では、ツールバーアイコンにバッジが表示され、そのページで非表示にされた要素の数が示されます。

## 高度な設定

上部の「高度な設定」タブをクリックすると、サイト別の設定（JSON形式）が表示されます。

*   **目的:** どのウェブサイトで、どのHTML要素をフィルタリング対象とするかを定義します。
*   **形式:** JSON配列形式で記述します。各要素は以下のキーを持つオブジェクトです。
    *   `hosts` (配列): 対象とするウェブサイトのホスト名（ドメイン名）を文字列の配列で指定します。`*.example.com` のようなワイルドカードも部分的に使用可能です。
    *   `selectors` (配列): そのホスト上で非表示対象とする要素を指定するCSSセレクターを文字列の配列で指定します。
*   **注意点:**
    *   JSONの構文（括弧 `{}`, 角括弧 `[]`, カンマ `,`, ダブルクォーテーション `"` など）を正しく記述してください。構文エラーがあると保存時にアラートが表示されます。
    *   **キーワードは全てのサイトで共通**です。サイトごとに異なるキーワードを設定することはできません。

**JSON設定例:**

```json
[
  {
    "hosts": ["news.example.com", "another.example.net"],
    "selectors": [".article-list > li", ".topic-item", "#main-feed > div"]
  },
  {
    "hosts": ["*.some-service.jp"],
    "selectors": [".timeline-entry", "article.post"]
  }
]

```

